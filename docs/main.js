!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button--disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},r=(e,t)=>e.querySelector(`#${t.id}-error`),o=(e,t,o)=>{r(e,t).textContent="",t.classList.remove(o.inputErrorClass)},n=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},a=(e,t,r)=>(e=>e.some((e=>!e.validity.valid)))(e)?n(t,r):((e,t)=>{e.disabled=!1,e.classList.remove(t.inactiveButtonClass)})(t,r),c=(e,t)=>{const r=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);r.forEach((r=>o(e,r,t))),n(a,t)};function s(e,t,r="Save",o="Saving..."){t.textContent=e?o:r}function i(e,t,r="Saving..."){t.preventDefault();const o=t.submitter,n=o.textContent;s(!0,o,n,r),e().then((()=>{t.target.reset()})).catch(console.error).finally((()=>{s(!1,o,n)}))}var d=e+"8650253b58b46f0f1c06.svg",l=e+"04c411e519a1c6561568.jpg",u=e+"1ecf96fab54a91c898b4.svg",_=e+"40608da7369d39bc1077.svg",m=e+"dba18798529f242c4c6d.svg",h=e+"e347123153a23d6a9a03.svg";const v=new class{constructor({baseUrl:e,headers:t}){this._baseUrl=e,this._headers=t,this._checkResponse=this._checkResponse.bind(this)}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResponse)}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}editUserInfo({name:e,about:t}){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._checkResponse)}editProfileAvatar({avatar:e}){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}addCard({name:e,link:t}){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}changeLikeStatus(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"ad37a010-2c01-4629-8987-9c2e7b09f127","Content-Type":"application/json"}}),y=document.querySelector(".profile__avatar");document.querySelector(".header__logo").src=d,y.src=l,document.querySelector(".profile__icon").src=u,document.querySelector(".add__icon").src=_,document.querySelector(".edit__profile-x-icon").src=m,document.querySelector(".new__post-x-icon").src=m,document.querySelector(".edit__avatar-x-icon").src=m,document.querySelector(".modal__delete-x-icon").src=h;const p=document.querySelector(".profile__edit-btn"),S=document.querySelector(".profile__name"),f=document.querySelector(".profile__description"),b=document.querySelector(".profile__avatar-btn"),q=document.querySelector("#edit-profile-modal"),k=q.querySelector(".modal__form"),E=q.querySelector(".modal__close-button"),L=q.querySelector("#profile-name-input"),g=q.querySelector("#profile-description-input"),C=document.querySelector("#edit-avatar-modal"),x=C.querySelector(".modal__form"),U=C.querySelector(".modal__close-button"),A=C.querySelector("#profile-avatar-input"),$=document.querySelector("#add-card-modal"),R=document.querySelector("#add-card-form"),P=document.querySelector(".profile__add-btn"),I=document.querySelector(".new__post-x-icon"),T=document.querySelector("#delete-modal"),w=T.querySelector(".modal__close-button-delete"),B=T.querySelector(".modal_cancel"),j=document.querySelector("#delete-form"),D=document.querySelector("#preview-modal"),N=D.querySelector(".modal__close-button_type_preview"),O=D.querySelector(".modal__image"),J=D.querySelector(".modal__caption"),H=document.querySelector("#card-template"),z=document.querySelector(".cards__list");function M(e){if("Escape"===e.key){const e=document.querySelector(".modal_opened");e&&G(e)}}function F(e){e.classList.add("modal_opened"),document.addEventListener("keydown",M)}function G(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",M)}function K(e){e.target===e.currentTarget&&G(e.target)}let Q,V;function W(e){const t=H.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=t.querySelector(".card__like-button"),a=t.querySelector(".card__delete-button");return r.textContent=e.name,o.src=e.link,o.alt=e.name,e.isLiked&&n.classList.add("card__like-button_active"),n.addEventListener("click",(t=>function(e,t){const r=e.target,o=r.classList.contains("card__like-button_active");v.changeLikeStatus(t,o).then((e=>{e.isLiked?r.classList.add("card__like-button_active"):r.classList.remove("card__like-button_active")})).catch(console.error)}(t,e._id))),a.addEventListener("click",(()=>{!function(e,t){Q=e,V=t._id,F(T)}(t,e)})),o.addEventListener("click",(()=>{O.src=e.link,O.alt=e.name,J.textContent=e.name,F(D)})),t}var X;v.getAppInfo().then((([e,t])=>{e.forEach((e=>{const t=W(e);z.append(t)})),S.textContent=t.name,f.textContent=t.about,y.src=t.avatar})).catch(console.error),k.addEventListener("submit",(e=>i((()=>v.editUserInfo({name:L.value,about:g.value}).then((e=>{S.textContent=e.name,f.textContent=e.about,G(q)}))),e))),R.addEventListener("submit",(e=>i((()=>{const r=R.querySelector("#card-title-input"),o=R.querySelector("#card-url-input");return v.addCard({name:r.value,link:o.value}).then((r=>{const o=W(r);z.prepend(o),G($),n(e.submitter,t)}))}),e))),x.addEventListener("submit",(e=>i((()=>v.editProfileAvatar({avatar:A.value}).then((e=>{y.src=e.avatar,G(C)}))),e))),j.addEventListener("submit",(e=>i((()=>V&&Q?v.deleteCard(V).then((()=>{Q.remove(),G(T),Q=null,V=null})):Promise.resolve()),e,"Deleting..."))),p.addEventListener("click",(()=>{L.value=S.textContent,g.value=f.textContent,c(k,t),F(q)})),P.addEventListener("click",(()=>F($))),b.addEventListener("click",(()=>{F(C),c(x,t)})),E.addEventListener("click",(()=>G(q))),U.addEventListener("click",(()=>G(C))),w.addEventListener("click",(()=>G(T))),B.addEventListener("click",(()=>{G(T),Q=null,V=null})),N.addEventListener("click",(()=>G(D))),I.addEventListener("click",(()=>G($))),[q,$,D,C,T].forEach((e=>{e.addEventListener("click",K)})),X=t,Array.from(document.querySelectorAll(X.formSelector)).forEach((e=>((e,t)=>{const n=Array.from(e.querySelectorAll(t.inputSelector)),c=e.querySelector(t.submitButtonSelector);a(n,c,t),n.forEach((s=>{s.addEventListener("input",(()=>{((e,t,n)=>{t.validity.valid?o(e,t,n):((e,t,o)=>{r(e,t).textContent=t.validationMessage,t.classList.add(o.inputErrorClass)})(e,t,n)})(e,s,t),a(n,c,t)}))}))})(e,X)))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VixFQUFLRSxjQUFjRyxFQUFPVixzQkFFekNrQixFQUFrQkMsRUFBUUosRUFBUUwsR0FFbENTLEVBQU9VLFNBQVN2QixJQUNkQSxFQUFNd0gsaUJBQWlCLFNBQVMsS0F0Q1RrQyxFQUFDM0osRUFBTUMsRUFBT0ksS0FDdkNKLEVBQU1lLFNBQVNDLE1BQ1hiLEVBQWVKLEVBQU1DLEVBQU9JLEdBZFh1SixFQUFDNUosRUFBTUMsRUFBT0ksS0FDbkJOLEVBQWdCQyxFQUFNQyxHQUM5QkssWUFBY0wsRUFBTTRKLGtCQUM1QjVKLEVBQU1NLFVBQVVLLElBQUlQLEVBQU9SLGtCQVl2QitKLENBQWU1SixFQUFNQyxFQUFPSSxJQW9DNUJzSixDQUFtQjNKLEVBQU1DLEVBQU9JLEdBQ2hDUSxFQUFrQkMsRUFBUUosRUFBUUwsVUFPZHFKLENBQWtCMUosRUFBTUssSSIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3NjcmlwdHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL2Zvcm1VdGlscy5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvdXRpbHMvQXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsImV4cG9ydCBjb25zdCB2YWxpZGF0aW9uQ29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnV0dG9uLS1kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yXCIsXHJcbn07XHJcblxyXG5jb25zdCBnZXRFcnJvckVsZW1lbnQgPSAoZm9ybSwgaW5wdXQpID0+XHJcbiAgZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dC5pZH0tZXJyb3JgKTtcclxuXHJcbmNvbnN0IHNob3dJbnB1dEVycm9yID0gKGZvcm0sIGlucHV0LCBjb25maWcpID0+IHtcclxuICBjb25zdCBlcnJvckVsID0gZ2V0RXJyb3JFbGVtZW50KGZvcm0sIGlucHV0KTtcclxuICBlcnJvckVsLnRleHRDb250ZW50ID0gaW5wdXQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgaW5wdXQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxufTtcclxuXHJcbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm0sIGlucHV0LCBjb25maWcpID0+IHtcclxuICBjb25zdCBlcnJvckVsID0gZ2V0RXJyb3JFbGVtZW50KGZvcm0sIGlucHV0KTtcclxuICBlcnJvckVsLnRleHRDb250ZW50ID0gXCJcIjtcclxuICBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGZvcm0sIGlucHV0LCBjb25maWcpID0+IHtcclxuICBpbnB1dC52YWxpZGl0eS52YWxpZFxyXG4gICAgPyBoaWRlSW5wdXRFcnJvcihmb3JtLCBpbnB1dCwgY29uZmlnKVxyXG4gICAgOiBzaG93SW5wdXRFcnJvcihmb3JtLCBpbnB1dCwgY29uZmlnKTtcclxufTtcclxuXHJcbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dHMpID0+XHJcbiAgaW5wdXRzLnNvbWUoKGlucHV0KSA9PiAhaW5wdXQudmFsaWRpdHkudmFsaWQpO1xyXG5cclxuY29uc3QgZGlzYWJsZUJ1dHRvbiA9IChidXR0b24sIGNvbmZpZykgPT4ge1xyXG4gIGJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgZW5hYmxlQnV0dG9uID0gKGJ1dHRvbiwgY29uZmlnKSA9PiB7XHJcbiAgYnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRzLCBidXR0b24sIGNvbmZpZykgPT5cclxuICBoYXNJbnZhbGlkSW5wdXQoaW5wdXRzKVxyXG4gICAgPyBkaXNhYmxlQnV0dG9uKGJ1dHRvbiwgY29uZmlnKVxyXG4gICAgOiBlbmFibGVCdXR0b24oYnV0dG9uLCBjb25maWcpO1xyXG5cclxuY29uc3QgcmVzZXRWYWxpZGF0aW9uID0gKGZvcm0sIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGlucHV0cyA9IEFycmF5LmZyb20oZm9ybS5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKSk7XHJcbiAgY29uc3QgYnV0dG9uID0gZm9ybS5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiBoaWRlSW5wdXRFcnJvcihmb3JtLCBpbnB1dCwgY29uZmlnKSk7XHJcbiAgZGlzYWJsZUJ1dHRvbihidXR0b24sIGNvbmZpZyk7XHJcbn07XHJcblxyXG5jb25zdCBzZXRFdmVudExpc3RlbmVycyA9IChmb3JtLCBjb25maWcpID0+IHtcclxuICBjb25zdCBpbnB1dHMgPSBBcnJheS5mcm9tKGZvcm0ucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcikpO1xyXG4gIGNvbnN0IGJ1dHRvbiA9IGZvcm0ucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG5cclxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dHMsIGJ1dHRvbiwgY29uZmlnKTtcclxuXHJcbiAgaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybSwgaW5wdXQsIGNvbmZpZyk7XHJcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0cywgYnV0dG9uLCBjb25maWcpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1zID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcclxuICBmb3Jtcy5mb3JFYWNoKChmb3JtKSA9PiBzZXRFdmVudExpc3RlbmVycyhmb3JtLCBjb25maWcpKTtcclxufTtcclxuXHJcbmV4cG9ydCB7XHJcbiAgZW5hYmxlVmFsaWRhdGlvbixcclxuICByZXNldFZhbGlkYXRpb24sXHJcbiAgZGlzYWJsZUJ1dHRvbixcclxuICBzaG93SW5wdXRFcnJvcixcclxuICBoaWRlSW5wdXRFcnJvcixcclxuICBjaGVja0lucHV0VmFsaWRpdHksXHJcbiAgaGFzSW52YWxpZElucHV0LFxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlLFxyXG59OyIsImV4cG9ydCBmdW5jdGlvbiByZW5kZXJMb2FkaW5nKFxyXG4gIGlzTG9hZGluZyxcclxuICBidXR0b24sXHJcbiAgYnV0dG9uVGV4dCA9IFwiU2F2ZVwiLFxyXG4gIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIlxyXG4pIHtcclxuICBidXR0b24udGV4dENvbnRlbnQgPSBpc0xvYWRpbmcgPyBsb2FkaW5nVGV4dCA6IGJ1dHRvblRleHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVTdWJtaXQocmVxdWVzdCwgZXZ0LCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBjb25zdCBzdWJtaXRCdXR0b24gPSBldnQuc3VibWl0dGVyO1xyXG4gIGNvbnN0IGluaXRpYWxUZXh0ID0gc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xyXG4gIHJlbmRlckxvYWRpbmcodHJ1ZSwgc3VibWl0QnV0dG9uLCBpbml0aWFsVGV4dCwgbG9hZGluZ1RleHQpO1xyXG5cclxuICByZXF1ZXN0KClcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgZXZ0LnRhcmdldC5yZXNldCgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICByZW5kZXJMb2FkaW5nKGZhbHNlLCBzdWJtaXRCdXR0b24sIGluaXRpYWxUZXh0KTtcclxuICAgIH0pO1xyXG59XHJcbiIsIi8vID09PT09PT09PT09PT09PT09PT09PSBJTVBPUlRTID09PT09PT09PT09PT09PT09PT09PVxyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQge1xyXG4gIGVuYWJsZVZhbGlkYXRpb24sXHJcbiAgdmFsaWRhdGlvbkNvbmZpZyxcclxuICByZXNldFZhbGlkYXRpb24sXHJcbiAgZGlzYWJsZUJ1dHRvbixcclxufSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL3V0aWxzL0FwaS5qc1wiO1xyXG5pbXBvcnQgeyBoYW5kbGVTdWJtaXQgfSBmcm9tIFwiLi4vdXRpbHMvZm9ybVV0aWxzLmpzXCI7XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT0gSU1BR0VTID09PT09PT09PT09PT09PT09PT09PVxyXG5pbXBvcnQgbG9nb0ltYWdlIGZyb20gXCIuLi9pbWFnZXMvbG9nby5zdmdcIjtcclxuaW1wb3J0IGF2YXRhckltYWdlIGZyb20gXCIuLi9pbWFnZXMvYmVzc2llX2F2YXRhci5qcGdcIjtcclxuaW1wb3J0IGVkaXRJbWFnZSBmcm9tIFwiLi4vaW1hZ2VzL3BlbmNpbC1pY29uLnN2Z1wiO1xyXG5pbXBvcnQgYWRkSW1hZ2UgZnJvbSBcIi4uL2ltYWdlcy9wbHVzLXNpZ24uc3ZnXCI7XHJcbmltcG9ydCBjbG9zZUltYWdlIGZyb20gXCIuLi9pbWFnZXMveC1pY29uLWhvdmVyLnN2Z1wiO1xyXG5pbXBvcnQgeEltYWdlIGZyb20gXCIuLi9pbWFnZXMveC1pY29uLWhvdmVyLnN2Z1wiO1xyXG5pbXBvcnQgZGVsZXRlQ2xvc2VJbWFnZSBmcm9tIFwiLi4vaW1hZ2VzL2RlbGV0ZS1tb2RhbC14LWljb24uc3ZnXCI7XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT0gQVBJIElOSVRJQUxJWkFUSU9OID09PT09PT09PT09PT09PT09PT09PVxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJhZDM3YTAxMC0yYzAxLTQ2MjktODk4Ny05YzJlN2IwOWYxMjdcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09IEVMRU1FTlQgU0VUVVAgPT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEhlYWRlciAvIFByb2ZpbGVcclxuY29uc3QgYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xyXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmhlYWRlcl9fbG9nb1wiKS5zcmMgPSBsb2dvSW1hZ2U7XHJcbmF2YXRhckVsZW1lbnQuc3JjID0gYXZhdGFySW1hZ2U7XHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faWNvblwiKS5zcmMgPSBlZGl0SW1hZ2U7XHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWRkX19pY29uXCIpLnNyYyA9IGFkZEltYWdlO1xyXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXRfX3Byb2ZpbGUteC1pY29uXCIpLnNyYyA9IGNsb3NlSW1hZ2U7XHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubmV3X19wb3N0LXgtaWNvblwiKS5zcmMgPSB4SW1hZ2U7XHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdF9fYXZhdGFyLXgtaWNvblwiKS5zcmMgPSBjbG9zZUltYWdlO1xyXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19kZWxldGUteC1pY29uXCIpLnNyYyA9IGRlbGV0ZUNsb3NlSW1hZ2U7XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT0gUFJPRklMRSBFTEVNRU5UUyA9PT09PT09PT09PT09PT09PT09PT1cclxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnRuXCIpO1xyXG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcclxuY29uc3QgcHJvZmlsZUF2YXRhckJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWJ0blwiKTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PSBNT0RBTFMgPT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEVkaXQgUHJvZmlsZVxyXG5jb25zdCBlZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtcHJvZmlsZS1tb2RhbFwiKTtcclxuY29uc3QgZWRpdEZvcm1FbGVtZW50ID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbmNvbnN0IGVkaXRNb2RhbENsb3NlQnV0dG9uID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcclxuY29uc3QgZWRpdE1vZGFsTmFtZUlucHV0ID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1uYW1lLWlucHV0XCIpO1xyXG5jb25zdCBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0ID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXHJcbik7XHJcblxyXG4vLyBFZGl0IEF2YXRhclxyXG5jb25zdCBlZGl0QXZhdGFyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtYXZhdGFyLW1vZGFsXCIpO1xyXG5jb25zdCBhdmF0YXJGb3JtID0gZWRpdEF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbmNvbnN0IGF2YXRhck1vZGFsQ2xvc2VCdG4gPSBlZGl0QXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcclxuICBcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCJcclxuKTtcclxuY29uc3QgYXZhdGFySW5wdXQgPSBlZGl0QXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWF2YXRhci1pbnB1dFwiKTtcclxuXHJcbi8vIEFkZCBDYXJkXHJcbmNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIik7XHJcbmNvbnN0IGFkZENhcmRGb3JtRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWZvcm1cIik7XHJcbmNvbnN0IHByb2ZpbGVBZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idG5cIik7XHJcbmNvbnN0IG5ld1Bvc3RDbG9zZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubmV3X19wb3N0LXgtaWNvblwiKTtcclxuXHJcbi8vIERlbGV0ZSBDYXJkXHJcbmNvbnN0IGRlbGV0ZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtbW9kYWxcIik7XHJcbmNvbnN0IGRlbGV0ZU1vZGFsQ2xvc2VCdG4gPSBkZWxldGVNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLm1vZGFsX19jbG9zZS1idXR0b24tZGVsZXRlXCJcclxuKTtcclxuY29uc3QgZGVsZXRlQ2FuY2VsQnRuID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9jYW5jZWxcIik7XHJcbmNvbnN0IGRlbGV0ZUZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1mb3JtXCIpO1xyXG5cclxuLy8gUHJldmlldyBJbWFnZVxyXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctbW9kYWxcIik7XHJcbmNvbnN0IHByZXZpZXdNb2RhbENsb3NlQnRuID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX2Nsb3NlLWJ1dHRvbl90eXBlX3ByZXZpZXdcIlxyXG4pO1xyXG5jb25zdCBwcmV2aWV3SW1hZ2VFbCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcclxuY29uc3QgcHJldmlld0NhcHRpb25FbCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09IENBUkQgRUxFTUVOVFMgPT09PT09PT09PT09PT09PT09PT09XHJcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKTtcclxuY29uc3QgY2FyZHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PSBBUEk6IExPQUQgSU5JVElBTCBEQVRBID09PT09PT09PT09PT09PT09PT09PVxyXG5hcGlcclxuICAuZ2V0QXBwSW5mbygpXHJcbiAgLnRoZW4oKFtjYXJkcywgdXNlckluZm9dKSA9PiB7XHJcbiAgICBjYXJkcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoaXRlbSk7XHJcbiAgICAgIGNhcmRzTGlzdC5hcHBlbmQoY2FyZEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHVzZXJJbmZvLm5hbWU7XHJcbiAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2VySW5mby5hYm91dDtcclxuICAgIGF2YXRhckVsZW1lbnQuc3JjID0gdXNlckluZm8uYXZhdGFyO1xyXG4gIH0pXHJcbiAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09IE1PREFMIEhFTFBFUlMgPT09PT09PT09PT09PT09PT09PT09XHJcbmZ1bmN0aW9uIGhhbmRsZUVzY2FwZShldnQpIHtcclxuICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgY29uc3Qgb3BlbmVkUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGlmIChvcGVuZWRQb3B1cCkge1xyXG4gICAgICBjbG9zZU1vZGFsKG9wZW5lZFBvcHVwKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xyXG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xyXG4gIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlT3ZlcmxheUNsaWNrKGUpIHtcclxuICBpZiAoZS50YXJnZXQgPT09IGUuY3VycmVudFRhcmdldCkge1xyXG4gICAgY2xvc2VNb2RhbChlLnRhcmdldCk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT0gQ0FSRCBGVU5DVElPTlMgPT09PT09PT09PT09PT09PT09PT09XHJcbmxldCBzZWxlY3RlZENhcmQ7XHJcbmxldCBzZWxlY3RlZENhcmRJZDtcclxuXHJcbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGRhdGEpIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jb250ZW50XHJcbiAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gIGNvbnN0IGNhcmROYW1lRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG4gIGNvbnN0IGNhcmRJbWFnZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICBjb25zdCBjYXJkTGlrZUJ0bkVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICBjb25zdCBjYXJkRGVsZXRlQnRuRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XHJcblxyXG4gIGNhcmROYW1lRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgY2FyZEltYWdlRWwuc3JjID0gZGF0YS5saW5rO1xyXG4gIGNhcmRJbWFnZUVsLmFsdCA9IGRhdGEubmFtZTtcclxuXHJcbiAgaWYgKGRhdGEuaXNMaWtlZCkge1xyXG4gICAgY2FyZExpa2VCdG5FbC5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gIH1cclxuICBjYXJkTGlrZUJ0bkVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4gY2hhbmdlTGlrZVN0YXR1cyhlLCBkYXRhLl9pZCkpO1xyXG5cclxuICBjYXJkRGVsZXRlQnRuRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEpO1xyXG4gIH0pO1xyXG5cclxuICBjYXJkSW1hZ2VFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgcHJldmlld0ltYWdlRWwuc3JjID0gZGF0YS5saW5rO1xyXG4gICAgcHJldmlld0ltYWdlRWwuYWx0ID0gZGF0YS5uYW1lO1xyXG4gICAgcHJldmlld0NhcHRpb25FbC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xyXG4gIH0pO1xyXG5cclxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNoYW5nZUxpa2VTdGF0dXMoZSwgaWQpIHtcclxuICBjb25zdCBsaWtlQnRuID0gZS50YXJnZXQ7XHJcbiAgY29uc3QgaXNMaWtlZCA9IGxpa2VCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG5cclxuICBhcGlcclxuICAgIC5jaGFuZ2VMaWtlU3RhdHVzKGlkLCBpc0xpa2VkKVxyXG4gICAgLnRoZW4oKHVwZGF0ZWRDYXJkKSA9PiB7XHJcbiAgICAgIGlmICh1cGRhdGVkQ2FyZC5pc0xpa2VkKSB7XHJcbiAgICAgICAgbGlrZUJ0bi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGxpa2VCdG4uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgZGF0YSkge1xyXG4gIHNlbGVjdGVkQ2FyZCA9IGNhcmRFbGVtZW50O1xyXG4gIHNlbGVjdGVkQ2FyZElkID0gZGF0YS5faWQ7XHJcbiAgb3Blbk1vZGFsKGRlbGV0ZU1vZGFsKTtcclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09IEZPUk0gU1VCTUlTU0lPTiA9PT09PT09PT09PT09PT09PT09PT1cclxuZWRpdEZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+XHJcbiAgaGFuZGxlU3VibWl0KCgpID0+IHtcclxuICAgIHJldHVybiBhcGlcclxuICAgICAgLmVkaXRVc2VySW5mbyh7XHJcbiAgICAgICAgbmFtZTogZWRpdE1vZGFsTmFtZUlucHV0LnZhbHVlLFxyXG4gICAgICAgIGFib3V0OiBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlLFxyXG4gICAgICB9KVxyXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEuYWJvdXQ7XHJcbiAgICAgICAgY2xvc2VNb2RhbChlZGl0TW9kYWwpO1xyXG4gICAgICB9KTtcclxuICB9LCBlKVxyXG4pO1xyXG5cclxuYWRkQ2FyZEZvcm1FbC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PlxyXG4gIGhhbmRsZVN1Ym1pdCgoKSA9PiB7XHJcbiAgICBjb25zdCB0aXRsZUlucHV0ID0gYWRkQ2FyZEZvcm1FbC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGl0bGUtaW5wdXRcIik7XHJcbiAgICBjb25zdCB1cmxJbnB1dCA9IGFkZENhcmRGb3JtRWwucXVlcnlTZWxlY3RvcihcIiNjYXJkLXVybC1pbnB1dFwiKTtcclxuXHJcbiAgICByZXR1cm4gYXBpXHJcbiAgICAgIC5hZGRDYXJkKHsgbmFtZTogdGl0bGVJbnB1dC52YWx1ZSwgbGluazogdXJsSW5wdXQudmFsdWUgfSlcclxuICAgICAgLnRoZW4oKGNhcmREYXRhKSA9PiB7XHJcbiAgICAgICAgY29uc3QgbmV3Q2FyZCA9IGdldENhcmRFbGVtZW50KGNhcmREYXRhKTtcclxuICAgICAgICBjYXJkc0xpc3QucHJlcGVuZChuZXdDYXJkKTtcclxuICAgICAgICBjbG9zZU1vZGFsKGFkZENhcmRNb2RhbCk7XHJcbiAgICAgICAgZGlzYWJsZUJ1dHRvbihlLnN1Ym1pdHRlciwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgICAgIH0pO1xyXG4gIH0sIGUpXHJcbik7XHJcblxyXG5hdmF0YXJGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+XHJcbiAgaGFuZGxlU3VibWl0KCgpID0+IHtcclxuICAgIHJldHVybiBhcGkuZWRpdFByb2ZpbGVBdmF0YXIoeyBhdmF0YXI6IGF2YXRhcklucHV0LnZhbHVlIH0pLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgYXZhdGFyRWxlbWVudC5zcmMgPSBkYXRhLmF2YXRhcjtcclxuICAgICAgY2xvc2VNb2RhbChlZGl0QXZhdGFyTW9kYWwpO1xyXG4gICAgfSk7XHJcbiAgfSwgZSlcclxuKTtcclxuXHJcbmRlbGV0ZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT5cclxuICBoYW5kbGVTdWJtaXQoXHJcbiAgICAoKSA9PiB7XHJcbiAgICAgIGlmICghc2VsZWN0ZWRDYXJkSWQgfHwgIXNlbGVjdGVkQ2FyZCkgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xyXG5cclxuICAgICAgcmV0dXJuIGFwaS5kZWxldGVDYXJkKHNlbGVjdGVkQ2FyZElkKS50aGVuKCgpID0+IHtcclxuICAgICAgICBzZWxlY3RlZENhcmQucmVtb3ZlKCk7XHJcbiAgICAgICAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XHJcbiAgICAgICAgc2VsZWN0ZWRDYXJkID0gbnVsbDtcclxuICAgICAgICBzZWxlY3RlZENhcmRJZCA9IG51bGw7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIGUsXHJcbiAgICBcIkRlbGV0aW5nLi4uXCJcclxuICApXHJcbik7XHJcbi8vID09PT09PT09PT09PT09PT09PT09PSBNT0RBTCBFVkVOVCBMSVNURU5FUlMgPT09PT09PT09PT09PT09PT09PT09XHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZWRpdE1vZGFsTmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XHJcbiAgZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcclxuICByZXNldFZhbGlkYXRpb24oZWRpdEZvcm1FbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICBvcGVuTW9kYWwoZWRpdE1vZGFsKTtcclxufSk7XHJcblxyXG5wcm9maWxlQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBvcGVuTW9kYWwoYWRkQ2FyZE1vZGFsKSk7XHJcblxyXG5wcm9maWxlQXZhdGFyQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgb3Blbk1vZGFsKGVkaXRBdmF0YXJNb2RhbCk7XHJcbiAgcmVzZXRWYWxpZGF0aW9uKGF2YXRhckZvcm0sIHZhbGlkYXRpb25Db25maWcpO1xyXG59KTtcclxuXHJcbmVkaXRNb2RhbENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjbG9zZU1vZGFsKGVkaXRNb2RhbCkpO1xyXG5hdmF0YXJNb2RhbENsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gIGNsb3NlTW9kYWwoZWRpdEF2YXRhck1vZGFsKVxyXG4pO1xyXG5kZWxldGVNb2RhbENsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKSk7XHJcbmRlbGV0ZUNhbmNlbEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG4gIHNlbGVjdGVkQ2FyZCA9IG51bGw7XHJcbiAgc2VsZWN0ZWRDYXJkSWQgPSBudWxsO1xyXG59KTtcclxucHJldmlld01vZGFsQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlTW9kYWwocHJldmlld01vZGFsKSk7XHJcblxyXG5uZXdQb3N0Q2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlTW9kYWwoYWRkQ2FyZE1vZGFsKSk7XHJcblxyXG5bZWRpdE1vZGFsLCBhZGRDYXJkTW9kYWwsIHByZXZpZXdNb2RhbCwgZWRpdEF2YXRhck1vZGFsLCBkZWxldGVNb2RhbF0uZm9yRWFjaChcclxuICAobW9kYWwpID0+IHtcclxuICAgIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVPdmVybGF5Q2xpY2spO1xyXG4gIH1cclxuKTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PSBGT1JNIFZBTElEQVRJT04gPT09PT09PT09PT09PT09PT09PT09XHJcbmVuYWJsZVZhbGlkYXRpb24odmFsaWRhdGlvbkNvbmZpZyk7XHJcbiIsImNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcblxyXG4gICAgdGhpcy5fY2hlY2tSZXNwb25zZSA9IHRoaXMuX2NoZWNrUmVzcG9uc2UuYmluZCh0aGlzKTtcclxuICB9XHJcblxyXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGdldEFwcEluZm8oKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0SW5pdGlhbENhcmRzKCksIHRoaXMuZ2V0VXNlckluZm8oKV0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGVkaXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgYWJvdXQgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZWRpdFByb2ZpbGVBdmF0YXIoeyBhdmF0YXIgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGFkZENhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBsaW5rIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGNoYW5nZUxpa2VTdGF0dXMoaWQsIGlzTGlrZWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBpc0xpa2VkID8gXCJERUxFVEVcIiA6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpO1xyXG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsInZhbGlkYXRpb25Db25maWciLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImdldEVycm9yRWxlbWVudCIsImZvcm0iLCJpbnB1dCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsImhpZGVJbnB1dEVycm9yIiwiY29uZmlnIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJkaXNhYmxlQnV0dG9uIiwiYnV0dG9uIiwiZGlzYWJsZWQiLCJhZGQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0cyIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZW5hYmxlQnV0dG9uIiwicmVzZXRWYWxpZGF0aW9uIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwiYnV0dG9uVGV4dCIsImxvYWRpbmdUZXh0IiwiaGFuZGxlU3VibWl0IiwicmVxdWVzdCIsImV2dCIsInByZXZlbnREZWZhdWx0Iiwic3VibWl0QnV0dG9uIiwic3VibWl0dGVyIiwiaW5pdGlhbFRleHQiLCJ0aGVuIiwidGFyZ2V0IiwicmVzZXQiLCJjYXRjaCIsImNvbnNvbGUiLCJlcnJvciIsImZpbmFsbHkiLCJhcGkiLCJjb25zdHJ1Y3RvciIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsImJpbmQiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0VXNlckluZm8iLCJmZXRjaCIsImdldEFwcEluZm8iLCJhbGwiLCJnZXRJbml0aWFsQ2FyZHMiLCJlZGl0VXNlckluZm8iLCJuYW1lIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImVkaXRQcm9maWxlQXZhdGFyIiwiYXZhdGFyIiwiYWRkQ2FyZCIsImxpbmsiLCJkZWxldGVDYXJkIiwiY2hhbmdlTGlrZVN0YXR1cyIsImlzTGlrZWQiLCJhdXRob3JpemF0aW9uIiwiYXZhdGFyRWxlbWVudCIsImRvY3VtZW50Iiwic3JjIiwibG9nb0ltYWdlIiwiYXZhdGFySW1hZ2UiLCJlZGl0SW1hZ2UiLCJhZGRJbWFnZSIsImNsb3NlSW1hZ2UiLCJ4SW1hZ2UiLCJkZWxldGVDbG9zZUltYWdlIiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlTmFtZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsInByb2ZpbGVBdmF0YXJCdG4iLCJlZGl0TW9kYWwiLCJlZGl0Rm9ybUVsZW1lbnQiLCJlZGl0TW9kYWxDbG9zZUJ1dHRvbiIsImVkaXRNb2RhbE5hbWVJbnB1dCIsImVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQiLCJlZGl0QXZhdGFyTW9kYWwiLCJhdmF0YXJGb3JtIiwiYXZhdGFyTW9kYWxDbG9zZUJ0biIsImF2YXRhcklucHV0IiwiYWRkQ2FyZE1vZGFsIiwiYWRkQ2FyZEZvcm1FbCIsInByb2ZpbGVBZGRCdXR0b24iLCJuZXdQb3N0Q2xvc2VCdXR0b24iLCJkZWxldGVNb2RhbCIsImRlbGV0ZU1vZGFsQ2xvc2VCdG4iLCJkZWxldGVDYW5jZWxCdG4iLCJkZWxldGVGb3JtIiwicHJldmlld01vZGFsIiwicHJldmlld01vZGFsQ2xvc2VCdG4iLCJwcmV2aWV3SW1hZ2VFbCIsInByZXZpZXdDYXB0aW9uRWwiLCJjYXJkVGVtcGxhdGUiLCJjYXJkc0xpc3QiLCJoYW5kbGVFc2NhcGUiLCJrZXkiLCJvcGVuZWRQb3B1cCIsImNsb3NlTW9kYWwiLCJvcGVuTW9kYWwiLCJtb2RhbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiaGFuZGxlT3ZlcmxheUNsaWNrIiwiZSIsImN1cnJlbnRUYXJnZXQiLCJzZWxlY3RlZENhcmQiLCJzZWxlY3RlZENhcmRJZCIsImdldENhcmRFbGVtZW50IiwiZGF0YSIsImNhcmRFbGVtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmROYW1lRWwiLCJjYXJkSW1hZ2VFbCIsImNhcmRMaWtlQnRuRWwiLCJjYXJkRGVsZXRlQnRuRWwiLCJhbHQiLCJsaWtlQnRuIiwiY29udGFpbnMiLCJ1cGRhdGVkQ2FyZCIsIl9pZCIsImhhbmRsZURlbGV0ZUNhcmQiLCJjYXJkcyIsInVzZXJJbmZvIiwiaXRlbSIsImFwcGVuZCIsInZhbHVlIiwidGl0bGVJbnB1dCIsInVybElucHV0IiwiY2FyZERhdGEiLCJuZXdDYXJkIiwicHJlcGVuZCIsInJlc29sdmUiLCJzZXRFdmVudExpc3RlbmVycyIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInNob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9